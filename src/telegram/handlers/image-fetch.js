import { wikiImageFor } from "../../services/wiki.js"; import { sendPhoto } from "../../utils/telegram.js"; import { dslToSvg, trySvgToPng } from "../../utils/render.js";
export function wantsImage(text){ return /(ØªØµÙˆÛŒØ±|Ø¹Ú©Ø³|image|photo|component|Ù‚Ø·Ø¹Ù‡)/i.test(text||""); }
export async function wikiFetchAndSend(text,token,chatId){ let q=text.replace(/.*?(ØªØµÙˆÛŒØ±|Ù‚Ø·Ø¹Ù‡|image|component)\s*/i,"").trim(); if(!q) q=text; const url=await wikiImageFor(q); if(!url) return false; await sendPhoto(token,chatId,url,`ðŸ”Ž ØªØµÙˆÛŒØ± Ø§Ø² ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§: ${q}`); return true; }
export async function handleSchematic(text,env){ const m=text.split(/\n/).slice(1).join("\n").trim(); const dsl=m||"R 10 10 R1\nC 60 10 C1\nWIRE 10 10 60 10"; const svg=dslToSvg(dsl,{width:600,height:400,title:"Saeed Schematic"}); const pngUrl=await trySvgToPng(svg,env); if(pngUrl) return {pngUrl}; return {svgText:svg}; }